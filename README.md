# Микелянджело дай пивчик

Идея проекта - попытаться повторить бот для знакомств "Леонардо дай винчик". Реализован весь основной функционал:
- Создание анкеты (прикрепление медиафайлов работает)
- Листание подходящих по возрасту и полу анкет (человек сам указывает какой пол его интересует, максимальная разница в возрасте с показываемыми анкетами 2 года)
- Редактирование анкеты
- Лайки на анкеты
- Просмотр входящих лайков, при взаимном лайке выдаётся ссылка на профиль человека который тебя лайкнул
- Пока что нету настройки местоположения
# Инструкция по локальному запуску
## Предусмотрено 2 варианта запуска:
1) Через docker-compose с СУБД PostgreSQL и Alembic для управления миграциями (рекомендуется для мощных серверов при большой нагрузке)
2) Без докера, просто программа python и СУБД sqlite
### Запуск через докер:
1) В корневой директории проекта создать файл .env и там установить настройки подключения к бд, а также токен вашего телеграмм бота, пример:
```
TOKEN=<your_token>
POSTGRES_USER=wisetree
POSTGRES_PASSWORD=123456789
POSTGRES_DB=mydb
DATABASE_URL=postgresql+asyncpg://wisetree:123456789@db:5432/mydb
```
2) Поднять докер (на виндовс просто запустите docker desktop, на линуксе выполните команду ```sudo systemctl start docker```)
3) Когда докер поднимется, откройте второй терминал и выполните ```sudo docker compose run --rm app alembic revision --autogenerate -m "New migration"``` а потом ```sudo docker compose run --rm app alembic upgrade head``` (создание таблиц в бд)
4) Готово, бот должен работать!
### Запуск через питон с sqlite:
1) Убедитесь, что на устройстве на котором запускаете установлен python
2) создать виртуальное окружение:

-для виндовс
```commandline
py -m venv venv
```

-для линукса
```commandline
python3 -m venv venv
```
3) активировать:

-для виндовс
```commandline
venv\Scripts\activate
```

-для линукса
```commandline
source venv/bin/activate
```
4) В корневой директории проекта создать файл .env и там установить URL для подключения к базе данных и токен бота, пример:
```
TOKEN=<your_token>
DATABASE_URL=sqlite+aiosqlite:///C:/path/to/base/database.db
```
Важно: путь до файла бд в URL должен быть абсолютным, а не относительным!

5) Перейдите в директорию db (```cd db```) и выполните ```python3 create_all_without_alembic.py``` (создание таблиц в бд)
6) Запустите скрипт, в корневой директории проекта выполните ```python3 main.py```
7) Готово, бот должен работать!
# Генерация документации
1) Перейдите в папку docs (```cd docs```)
2) выполните команду ```make html``` (если не сработало, то ```.\make html```)
3) Теперь, когда документация сгенерирована, откройте в браузере файл который располагается по адресу ```docs/build/html/index.html```